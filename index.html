async function buyOnBalancer() {  
    const token = document.getElementById("tokenAddress").value;  
    const amountToBuy = document.getElementById("amount").value;  

    if (!token || !amountToBuy) {  
        return setStatus("Enter a token address and amount", true);  
    }  

    try {  
        // Convert amount to Wei (for USDC)  
        const usdcAmountIn = web3.utils.toWei(amountToBuy.toString(), 'mwei');  
        const balancerRouter = new web3.eth.Contract([ /* Balancer Router ABI */ ], BALANCER_ROUTER);  
        
        // Approve Balancer to spend USDC  
        const usdcContract = new web3.eth.Contract([  
            {  
                "constant": false,  
                "inputs": [{ "name": "spender", "type": "address" }, { "name": "value", "type": "uint256" }],  
                "name": "approve",  
                "outputs": [{ "name": "", "type": "bool" }],  
                "payable": false,  
                "stateMutability": "nonpayable",  
                "type": "function"  
            }  
        ], USDC);  

        // Approving the token transfer  
        const approval = await usdcContract.methods.approve(BALANCER_ROUTER, usdcAmountIn).send({ from: account });  
        console.log("USDC approved for spending:", approval);  
        setStatus("Approved USDC spending. Buying...");  

        // Begin the trading process  
        const result = await balancerRouter.methods.swapExactTokensForTokens(  
            usdcAmountIn,  
            0, // amountOutMin, can adjust based on slippage preferences  
            [USDC, token],  
            account,  
            Math.floor(Date.now() / 1000) + 60 * 20 // deadline  
        ).send({ from: account });  

        console.log("Transaction success:", result);  
        setStatus("Purchase completed successfully!");  
        updateBalances();  

    } catch (error) {  
        console.error("Error in buyOnBalancer:", error);  
        setStatus(`Error occurred in buyOnBalancer: ${error.message}`, true);  
    }  
}  

async function sellOnQuickSwap() {  
    const token = document.getElementById("tokenAddress").value;  
    const amountToSell = document.getElementById("amount").value;  

    if (!token || !amountToSell) {  
        return setStatus("Enter a token address and amount to sell", true);  
    }  

    try {  
        // Convert token amount to Wei (assuming token has 18 decimals)  
        const tokenAmountIn = web3.utils.toWei(amountToSell.toString(), 'ether');  
        const quickswapRouter = new web3.eth.Contract([ /* QuickSwap Router ABI */ ], QUICKSWAP_ROUTER);  

        // Approve QuickSwap to spend the specified amount of the token  
        const tokenContract = new web3.eth.Contract([  
            {  
                "constant": false,  
                "inputs": [{ "name": "spender", "type": "address" }, { "name": "value", "type": "uint256" }],  
                "name": "approve",  
                "outputs": [{ "name": "", "type": "bool" }],  
                "payable": false,  
                "stateMutability": "nonpayable",  
                "type": "function"  
            }  
        ], token);  

        // Approving the token transfer  
        const approval = await tokenContract.methods.approve(QUICKSWAP_ROUTER, tokenAmountIn).send({ from: account });  
        console.log("Token approved for spending:", approval);  
        setStatus("Approved token spending. Selling...");  

        // Begin selling process  
        const path = [token, USDC]; // Selling token for USDC  
        const result = await quickswapRouter.methods.swapExactTokensForTokens(  
            tokenAmountIn,  
            0, // amountOutMin  
            path,  
            account,  
            Math.floor(Date.now() / 1000) + 60 * 20 // deadline  
        ).send({ from: account });  

        console.log("Transaction success:", result);  
        setStatus("Sale completed successfully!");  
        updateBalances();  

    } catch (error) {  
        console.error("Error in sellOnQuickSwap:", error);  
        setStatus(`Error occurred in sellOnQuickSwap: ${error.message}`, true);  
    }  
}  

function setStatus(msg, isError = false) {  
    const el = document.getElementById("status");  
    el.innerText = msg;  
    el.className = isError ? "error" : "";  
}
